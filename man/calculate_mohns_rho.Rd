% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mohns_rho.r
\name{calculate_mohns_rho}
\alias{calculate_mohns_rho}
\title{Calculate Mohn's rho for retrospective analysis}
\usage{
calculate_mohns_rho(retro_fit, quantity, ref_year = NULL)
}
\arguments{
\item{retro_fit}{List returned by the \code{\link[=run_fims_retrospective]{run_fims_retrospective()}} function
containing \code{years_to_remove} (vector of years peeled) and \code{estimates}
(data frame with retrospective results)}

\item{quantity}{Character string specifying which quantity to calculate
Mohn's rho for (e.g., "spawning_biomass", "recruitment")}

\item{ref_year}{Optional numeric value specifying the reference year to use
for calculation. If NULL (default), uses the approach where each peel is
compared to the base model at the peel's terminal year.}
}
\value{
A numeric value representing Mohn's rho. Values close to zero indicate
minimal retrospective bias. Positive values suggest the model retrospectively
underestimates the quantity, while negative values suggest overestimation.
}
\description{
Calculates Mohn's rho, a diagnostic statistic that summarizes the bias in
retrospective analysis. The statistic measures the average relative difference
between estimates from retrospective peels and the reference model at the
corresponding terminal year of each peel. A value close to zero suggests
minimal retrospective bias, while larger absolute values indicate potential
model misspecification or data conflicts.
}
\details{
The formula for Mohn's rho is:
\deqn{\rho = \frac{1}{n} \sum_{i=1}^{n} \frac{x_{peel,i} - x_{base,i}}{x_{base,i}}}
where n is the number of retrospective peels, \eqn{x_{peel,i}} is the
estimated value from peel i at its terminal year, and \eqn{x_{base,i}} is
the value from the base model at that same year.
}
\examples{
\dontrun{
library(FIMS)
# Use built-in dataset from FIMS
data("data1")
# Prepare data for FIMS model
data_4_model <- FIMSFrame(data1)
# Create parameters
parameters <- data_4_model |>
  create_default_configurations() |>
  create_default_parameters(data = data_4_model)

# Run retrospective analysis
retro_fit <- run_fims_retrospective(
  years_to_remove = 0:5,
  data = data1,
  parameters = parameters,
  n_cores = 1
)

# Calculate Mohn's rho for spawning biomass
rho_ssb <- calculate_mohns_rho(retro_fit, quantity = "spawning_biomass")

# Calculate Mohn's rho for recruitment
rho_rec <- calculate_mohns_rho(retro_fit, quantity = "recruitment")
}
}
\references{
Mohn, R. (1999). The retrospective problem in sequential population analysis:
An investigation using cod fishery and simulated data. ICES Journal of Marine
Science, 56(4), 473-488.

Hurtado-Ferro, F., Szuwalski, C.S., Valero, J.L., Anderson, S.C., Cunningham,
C.J., Johnson, K.F., Licandeo, R., McGilliard, C.R., Monnahan, C.C., Muradian,
M.L., Ono, K., Vert-Pre, K.A., Whitten, A.R., and Punt, A.E. (2015). Looking
in the rear-view mirror: bias and retrospective patterns in integrated,
age-structured stock assessment models. ICES Journal of Marine Science, 72(1),
99-110.
}
