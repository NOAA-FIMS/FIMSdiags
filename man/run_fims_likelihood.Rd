% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fims_likelihood.r
\name{run_fims_likelihood}
\alias{run_fims_likelihood}
\title{Run Likelihood Profile}
\usage{
run_fims_likelihood(
  model,
  parameters,
  data,
  module_name = NULL,
  parameter_name = "log_rzero",
  n_cores = NULL,
  min = -2,
  max = 2,
  length = 5
)
}
\arguments{
\item{model}{A FIMSFit object returned by \code{\link[FIMS:fit_fims]{FIMS::fit_fims()}}. Used to extract
the estimated value of the parameter being profiled}

\item{parameters}{A FIMS parameters object created by
\code{\link[FIMS:create_default_parameters]{FIMS::create_default_parameters()}}, containing the model configuration
and initial parameter values}

\item{data}{A data frame, tibble, or FIMSFrame object containing the model
data. This should include all data types required by FIMS}

\item{module_name}{A character string specifying the module containing the
parameter to profile. Default is \code{NULL}. Required when the parameter name
exists in multiple modules (e.g., multiple fleets). Examples include
\code{"fleet1"}, \code{"survey1"}, or \code{"recruitment"}}

\item{parameter_name}{A character string specifying the parameter to profile.
Default is \code{"log_rzero"}. Must match a parameter name in the FIMS model.
Common options include \code{"log_rzero"}, \code{"log_sigma_recruit"}, \code{"logit_steep"},
or selectivity parameters}

\item{n_cores}{An integer specifying the number of CPU cores to use for
parallel processing. If \code{NULL} (default), uses \code{parallel::detectCores() - 1}.
Set to 1 for sequential processing. Must be a positive integer}

\item{min}{A numeric value specifying the minimum offset from the estimated
parameter value. Default is \code{-2}. The profile range starts at
\code{estimated_value + min}}

\item{max}{A numeric value specifying the maximum offset from the estimated
parameter value. Default is \code{2}. The profile range ends at
\code{estimated_value + max}. Must be greater than \code{min}}

\item{length}{An integer specifying the number of points in the likelihood
profile. Default is \code{5}. Use an odd number to include the estimated value.
Must be a positive integer. Values above 50 will generate a warning}
}
\value{
A list with two named elements:
\itemize{
\item \code{vec} - Numeric vector of parameter values used in the profile
\item \code{estimates} - Data frame containing model estimates for each profiled value,
with the following key columns:
\itemize{
\item \code{label} - Type of estimate (e.g., "spawning_biomass", "recruitment")
\item \code{year_i} - Year index for the estimate
\item \code{age_i} - Age index (if applicable)
\item \code{estimated} - Point estimate value
\item \code{uncertainty} - Standard error of the estimate
\item \code{lpdf} - Log probability density (negative log-likelihood component)
\item \verb{value_\{parameter_name\}} - The fixed parameter value for this profile point
}
}
}
\description{
Conducts likelihood profile analysis for a FIMS model by fixing a specified
parameter at a range of values and re-optimizing all other parameters. This
diagnostic tool helps assess parameter uncertainty, identifiability, and
potential local minima in the likelihood surface.
}
\details{
Run Likelihood Profile for a FIMS Model

Likelihood profiling involves systematically varying a parameter of interest
across a range of values while optimizing all other parameters. At each fixed
value, the negative log-likelihood is recorded, creating a profile of the
likelihood surface. This reveals whether the parameter is well-estimated
(sharp, parabolic profile) or poorly identified (flat profile), and can
identify multiple modes or asymmetric confidence regions.

The function profiles over values specified relative to the estimated value
from the base model. For example, with \code{min = -2} and \code{max = 2}, the profile
spans from 2 units below to 2 units above the estimated value. The profiled
values are evenly spaced on the parameter scale (not log scale).

Models are run in parallel for computational efficiency. The function
automatically handles parameter identification using module names when needed
to distinguish between multiple instances of the same parameter type.
}
\examples{
\dontrun{
library(FIMS)

# Use built-in dataset from FIMS
data("data1")
data_4_model <- FIMSFrame(data1)

# Create a parameters object
parameters <- data_4_model |>
  create_default_configurations() |>
  create_default_parameters(data = data_4_model)

# Run the base model with optimization
base_model <- parameters |>
  initialize_fims(data = data_4_model) |>
  fit_fims(optimize = TRUE)

# Run likelihood profile for log_rzero
like_fit <- run_fims_likelihood(
  model = base_model,
  parameters = parameters,
  data = data1,
  parameter_name = "log_rzero",
  n_cores = 3,
  min = -1,
  max = 1,
  length = 21
)

# View the profiled parameter values
like_fit$vec

# View structure of estimates
head(like_fit$estimates)
}

}
\references{
Venzon, D.J. and Moolgavkar, S.H. 1988. A method for computing
profile-likelihood-based confidence intervals. Applied Statistics 37: 87-94.

Maunder, M.N. and Punt, A.E. 2013. A review of integrated analysis in
fisheries stock assessment. Fisheries Research 142: 61-74.
}
\seealso{
\itemize{
\item \code{\link[=plot_likelihood]{plot_likelihood()}} for visualizing likelihood profiles
\item \code{\link[FIMS:fit_fims]{FIMS::fit_fims()}} for fitting FIMS models
\item \code{\link[FIMS:create_default_parameters]{FIMS::create_default_parameters()}} for creating parameter objects
}

Other diagnostic_functions: 
\code{\link{plot_likelihood}()},
\code{\link{plot_retrospective}()},
\code{\link{run_fims_retrospective}()}
}
\concept{diagnostic_functions}
